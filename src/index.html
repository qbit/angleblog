<html ng-app>
<head>
	<title>Bold Daemon</title>
	<link href="components/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
	<script src="components/angular/angular.min.js"></script>
	<script>
		function get($scope, $http, url, name) {
			$http.get( url ).success( function( d, s ) {
				$scope[name] = d;
			});
		}

		function repoCtrl($scope, $http) {
			get($scope, $http, 'https://api.github.com/users/qbit/repos?sort=updated', 'repos');
			// get($scope, $http, 'components/bolddaemon/repos.json', 'repos');
		}

		function dataCtrl($scope, $http) {
			get($scope, $http, 'components/bolddaemon/categories.json', 'categories');
			get($scope, $http, 'components/bolddaemon/posts.json', 'posts');

			$scope.setSearch = function(cat) {
				$scope.search = cat.name;
			};
		}

		function cwCtrl($scope, $http) {
			$http.jsonp( 'https://coderwall.com/qbit.json?callback=JSON_CALLBACK' ).success( function( d, s ) {
				$scope.badges = d.data.badges;
			});
		}

	</script>
	<style>
		body {
		  font-family: Roboto, arial, sans-serif;
		}

		input {
			margin-top: 5px;
			padding-left: 5px;
			outline: none;
			border: 1px solid #000;
		}

		.badge {
		  width: 30px;
		  height: 30px;
		}

		ul {
			list-style: none;
			padding: 0;
			margin: 0;
		}

		li {
			padding-left: 1em;
			text-indent: -.7em;
		}

		li:before {
			content: "â€º "
		}
	</style>
</head>
<body>
	<div class="container-fluid" ng-controller="dataCtrl">
		<div class="row-fluid">
			<div class="span2">
				<div>
					<img src="components/bolddaemon/puffer-small.png"><br>
					<input width="20" placeholder="search.." ng-model="search">
				</div>
				<div id="repos" ng-controller="repoCtrl">
					<h3>Recent Projects</h3>
					<ul>
						<li ng-repeat="repo in repos | filter:search | limitTo:10">
						<a href="{{repo.html_url}}" title="{{repo.description}}">{{repo.name}}</a>
						</li>
					</ul>
				</div>
				<div id="categories">
					<h3>Blog Categories</h3>
					<ul>
						<li ng-repeat="category in categories">
							<a href="#" ng-click="setSearch(category)">{{category.name}}</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="span8" id="posts">
				<div class="post" ng-repeat="post in posts | filter:search | limitTo:5">
					<h3>{{post.title}}</h3>
					<i>{{post.author}} - {{post.date}}</i>
					<hr>
					<p ng-bind-html-unsafe="post.body">{{post.body}}</p>
				</div>
				<div class="span10" ng-controller="cwCtrl">
					<img ng-repeat="badge in badges" class="badge" ng-src={{badge.badge}} alt={{badge.description}}>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

